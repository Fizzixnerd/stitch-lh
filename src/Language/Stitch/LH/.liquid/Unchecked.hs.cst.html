<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Language/Stitch/LH/Unchecked.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##1519 : GHC.Types.Module | $k_##1520}</span><span class='hs-comment'>-----------------------------------------------------------------------------</span></a>
<span class=hs-linenum>  2: </span><span class='hs-comment'>-- |</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>-- Module      :  Language.Stitch.LH.Unchecked</span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>-- Copyright   :  (C) 2015 Richard Eisenberg</span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>--                (C) 2021 Facundo Domínguez</span>
<span class=hs-linenum>  6: </span><span class='hs-comment'>-- License     :  BSD-style (see LICENSE)</span>
<span class=hs-linenum>  7: </span><span class='hs-comment'>-- Stability   :  experimental</span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>-- Defines the AST for un-type-checked expressions</span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>--</span>
<span class=hs-linenum> 11: </span><span class='hs-comment'>----------------------------------------------------------------------------</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>{-# LANGUAGE LambdaCase #-}</span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>{-# OPTIONS_GHC -fplugin=LiquidHaskell #-}</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--exact-data-cons"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 16: </span>
<span class=hs-linenum> 17: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Language.Stitch.LH.Unchecked</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 18: </span>
<span class=hs-linenum> 19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Pretty</span>
<span class=hs-linenum> 20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Type</span>
<span class=hs-linenum> 21: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Op</span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Util</span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Data.Nat</span> <span class='hs-keyword'>as</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum> 24: </span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.PrettyPrint.ANSI.Leijen</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 29: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UVar</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum> 30: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UGlobal</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 31: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ULam</span> <span class='hs-conid'>Ty</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 32: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UApp</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 33: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ULet</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 34: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UArith</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>ArithOp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 35: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UCond</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 36: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UFix</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 37: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UIntE</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 38: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UBoolE</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 39: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-comment'>-- | Unchecked expression</span>
<span class=hs-linenum> 42: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 43: </span>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>UVar</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum> 44: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UGlobal</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 45: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ULam</span> <span class='hs-conid'>Ty</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 46: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UApp</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 47: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>ULet</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 48: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UArith</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>ArithOp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 49: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UCond</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 50: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UFix</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 51: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UIntE</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 52: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-conid'>UBoolE</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 53: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 54: </span>
<span class=hs-linenum> 55: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum> 56: </span><span class='hs-definition'>measure</span> <span class='hs-varid'>numFreeVars</span>
<span class=hs-linenum> 57: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UExp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum> 58: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 59: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UExp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum> 60: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2525:Language.Stitch.LH.Unchecked.UExp -&gt; {VV : GHC.Types.Int | VV == Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##2525
                                                                          &amp;&amp; VV &gt;= 0}</span><span class='hs-definition'>numFreeVars</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>UVar</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2563 : GHC.Types.Int | lq_tmp$x##2563 == v##adg6
                                  &amp;&amp; lq_tmp$x##2563 &gt;= 0}</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2544 : GHC.Types.Int | lq_tmp$x##2544 == (lq_anf$##7205759403792845761##ddzj : int)}</span><span class='hs-num'>1</span></a>
<span class=hs-linenum> 61: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UGlobal</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2584 : GHC.Prim.Int# | lq_tmp$x##2584 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 62: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>ULam</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2627:GHC.Types.Int -&gt; lq_tmp$x##2628:GHC.Types.Int -&gt; {lq_tmp$x##2624 : GHC.Types.Int | lq_tmp$x##2624 == (if 0 &gt; lq_tmp$x##2627 - lq_tmp$x##2628 then 0 else lq_tmp$x##2627 - lq_tmp$x##2628)}</span><span class='hs-conid'>Nat.minus</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2609 : GHC.Types.Int | lq_tmp$x##2609 == Language.Stitch.LH.Unchecked.numFreeVars body##adg7
                                  &amp;&amp; lq_tmp$x##2609 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2612 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2612 == body##adg7}</span><span class='hs-varid'>body</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2617 : GHC.Types.Int | lq_tmp$x##2617 == (lq_anf$##7205759403792845765##ddzn : int)}</span><span class='hs-num'>1</span></a>
<span class=hs-linenum> 63: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UApp</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2675 : (GHC.Classes.Ord GHC.Types.Int) | lq_tmp$x##2675 == GHC.Classes.$fOrdInt}</span><span class='hs-conid'>Nat.max</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2649 : GHC.Types.Int | lq_tmp$x##2649 == Language.Stitch.LH.Unchecked.numFreeVars e1##adg8
                                  &amp;&amp; lq_tmp$x##2649 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2652 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2652 == e1##adg8}</span><span class='hs-varid'>e1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2655 : GHC.Types.Int | lq_tmp$x##2655 == Language.Stitch.LH.Unchecked.numFreeVars e2##adg9
                                  &amp;&amp; lq_tmp$x##2655 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2658 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2658 == e2##adg9}</span><span class='hs-varid'>e2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 64: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>ULet</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 65: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##2740 : (GHC.Classes.Ord GHC.Types.Int) | lq_tmp$x##2740 == GHC.Classes.$fOrdInt}</span><span class='hs-conid'>Nat.max</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2696 : GHC.Types.Int | lq_tmp$x##2696 == Language.Stitch.LH.Unchecked.numFreeVars e1##adga
                                  &amp;&amp; lq_tmp$x##2696 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2699 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2699 == e1##adga}</span><span class='hs-varid'>e1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2717 : GHC.Types.Int | lq_tmp$x##2717 == (if 0 &gt; lq_anf$##7205759403792845770##ddzs - lq_anf$##7205759403792845772##ddzu then 0 else lq_anf$##7205759403792845770##ddzs - lq_anf$##7205759403792845772##ddzu)}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Nat.minus</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2702 : GHC.Types.Int | lq_tmp$x##2702 == Language.Stitch.LH.Unchecked.numFreeVars e2##adgb
                                  &amp;&amp; lq_tmp$x##2702 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2705 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2705 == e2##adgb}</span><span class='hs-varid'>e2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2710 : GHC.Types.Int | lq_tmp$x##2710 == (lq_anf$##7205759403792845771##ddzt : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 66: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UArith</span> <span class='hs-varid'>e1</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>e2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2793 : (GHC.Classes.Ord GHC.Types.Int) | lq_tmp$x##2793 == GHC.Classes.$fOrdInt}</span><span class='hs-conid'>Nat.max</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2767 : GHC.Types.Int | lq_tmp$x##2767 == Language.Stitch.LH.Unchecked.numFreeVars e1##adgc
                                  &amp;&amp; lq_tmp$x##2767 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2770 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2770 == e1##adgc}</span><span class='hs-varid'>e1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2773 : GHC.Types.Int | lq_tmp$x##2773 == Language.Stitch.LH.Unchecked.numFreeVars e2##adgd
                                  &amp;&amp; lq_tmp$x##2773 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2776 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2776 == e2##adgd}</span><span class='hs-varid'>e2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 67: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UCond</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum> 68: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##2871 : (GHC.Classes.Ord GHC.Types.Int) | lq_tmp$x##2871 == GHC.Classes.$fOrdInt}</span><span class='hs-conid'>Nat.max</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2844 : GHC.Types.Int | lq_tmp$x##2844 == (if lq_anf$##7205759403792845776##ddzy &gt; lq_anf$##7205759403792845777##ddzz then lq_anf$##7205759403792845776##ddzy else lq_anf$##7205759403792845777##ddzz)
                                  &amp;&amp; $k_##2843[VV##2842:=lq_tmp$x##2844][lq_tmp$x##2839:=GHC.Classes.$fOrdInt][lq_tmp$x##2840:=lq_anf$##7205759403792845776##ddzy][lq_tmp$x##2841:=lq_anf$##7205759403792845777##ddzz]}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>Nat.max</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2820 : GHC.Types.Int | lq_tmp$x##2820 == Language.Stitch.LH.Unchecked.numFreeVars e1##adge
                                  &amp;&amp; lq_tmp$x##2820 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2823 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2823 == e1##adge}</span><span class='hs-varid'>e1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2826 : GHC.Types.Int | lq_tmp$x##2826 == Language.Stitch.LH.Unchecked.numFreeVars e2##adgf
                                  &amp;&amp; lq_tmp$x##2826 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2829 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2829 == e2##adgf}</span><span class='hs-varid'>e2</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2851 : GHC.Types.Int | lq_tmp$x##2851 == Language.Stitch.LH.Unchecked.numFreeVars e3##adgg
                                  &amp;&amp; lq_tmp$x##2851 &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>numFreeVars</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2854 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2854 == e3##adgg}</span><span class='hs-varid'>e3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 69: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UFix</span> <span class='hs-varid'>body</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2525:Language.Stitch.LH.Unchecked.UExp -&gt; {VV : GHC.Types.Int | VV == Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##2525
                                                                          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>numFreeVars</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2889 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##2889 == body##adgh}</span><span class='hs-varid'>body</span></a>
<span class=hs-linenum> 70: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UIntE</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2901 : GHC.Prim.Int# | lq_tmp$x##2901 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 71: </span><span class='hs-definition'>numFreeVars</span> <span class='hs-layout'>(</span><span class='hs-conid'>UBoolE</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2919 : GHC.Prim.Int# | lq_tmp$x##2919 == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum> 74: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>VarsSmallerThan</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span> <span class='hs-varid'>e</span> <span class='hs-conop'>:</span> <span class='hs-conid'>UExp</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>numFreeVars</span> <span class='hs-varid'>e</span> <span class='hs-varop'>&lt;=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>}</span>
<span class=hs-linenum> 75: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>ClosedUExp</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span> <span class='hs-varid'>e</span> <span class='hs-conop'>:</span> <span class='hs-conid'>UExp</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>numFreeVars</span> <span class='hs-varid'>e</span> <span class='hs-varop'>==</span> <span class='hs-num'>0</span> <span class='hs-layout'>}</span>
<span class=hs-linenum> 76: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 77: </span>
<span class=hs-linenum> 78: </span><span class='hs-comment'>-- An expression paired with the bound for the valid</span>
<span class=hs-linenum> 79: </span><span class='hs-comment'>-- variable indices</span>
<span class=hs-linenum> 80: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedUExp</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedUExp</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>VarsSmallerThan</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 81: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedUExp</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedUExp</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-conid'>UExp</span>
<span class=hs-linenum> 82: </span>  <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-keyword'>instance</span> <a class=annot href="#"><span class=annottext>(Text.PrettyPrint.ANSI.Leijen.Internal.Pretty Language.Stitch.LH.Unchecked.ScopedUExp)</span><span class='hs-conid'>Pretty</span></a> <span class='hs-conid'>ScopedUExp</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 85: </span>  <a class=annot href="#"><span class=annottext>ds_ddsu:{VV##4850 : Language.Stitch.LH.Unchecked.ScopedUExp | $k_##4851} -&gt; {VV##4853 : Text.PrettyPrint.ANSI.Leijen.Internal.Doc | $k_##4854}</span><span class='hs-varid'>pretty</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>ScopedUExp</span> <span class='hs-varid'>n</span> <span class='hs-varid'>e</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##2937:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0} -&gt; lq_tmp$x##2938:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##2939:{VV##0 : Language.Stitch.LH.Unchecked.UExp | Language.Stitch.LH.Unchecked.numFreeVars VV##0 &lt;= lq_tmp$x##2937} -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4885 : GHC.Types.Int | lq_tmp$x##4885 == n##adg4
                                  &amp;&amp; lq_tmp$x##4885 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4887 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4887 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4888 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4888 == e##adg5
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4888 &gt;= 0
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4888 &lt;= n##adg4}</span><span class='hs-varid'>e</span></a>
<span class=hs-linenum> 86: </span>
<span class=hs-linenum> 87: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prettyExp</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span> <span class='hs-conop'>:</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VarsSmallerThan</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Doc</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 88: </span><span class='hs-definition'>prettyExp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prec</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UExp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Doc</span>
<span class=hs-linenum> 89: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2937:{VV##0 : GHC.Types.Int | VV##0 &gt;= 0} -&gt; lq_tmp$x##2938:(GHC.Real.Ratio GHC.Integer.Type.Integer) -&gt; lq_tmp$x##2939:{VV##0 : Language.Stitch.LH.Unchecked.UExp | Language.Stitch.LH.Unchecked.numFreeVars VV##0 &lt;= lq_tmp$x##2937} -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-definition'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : GHC.Types.Int | VV##0 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>prec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>\</span><span class='hs-keyword'>case</span>
<span class=hs-linenum> 90: </span>  <span class='hs-conid'>UVar</span> <span class='hs-varid'>v</span>       <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3007:Language.Stitch.LH.Pretty.ScopedVar -&gt; lq_tmp$x##3008:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>applyColor</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2959 : Language.Stitch.LH.Pretty.ScopedVar | is$Language.Stitch.LH.Pretty.ScopedVar lq_tmp$x##2959
                                                        &amp;&amp; lq_tmp$x##2959 == Language.Stitch.LH.Pretty.ScopedVar n##adgi v##adgk
                                                        &amp;&amp; Language.Stitch.LH.Pretty.maxIndex lq_tmp$x##2959 == n##adgi
                                                        &amp;&amp; Language.Stitch.LH.Pretty.scopedIndex lq_tmp$x##2959 == v##adgk}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>ScopedVar</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2964 : GHC.Types.Int | lq_tmp$x##2964 == n##adgi
                                  &amp;&amp; lq_tmp$x##2964 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2965 : GHC.Types.Int | lq_tmp$x##2965 == v##adgk
                                  &amp;&amp; lq_tmp$x##2965 &gt;= 0}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>char</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2968 : GHC.Types.Char | lq_tmp$x##2968 == ((lit "35" Char) : Char)}</span><span class='hs-chr'>'#'</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>int</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2983 : GHC.Types.Int | lq_tmp$x##2983 == v##adgk
                                  &amp;&amp; lq_tmp$x##2983 &gt;= 0}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 91: </span>
<span class=hs-linenum> 92: </span>  <span class='hs-conid'>UGlobal</span> <span class='hs-varid'>name</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3037:[GHC.Types.Char] -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3042 : [GHC.Types.Char] | lq_tmp$x##3042 == name##adgl
                                     &amp;&amp; len lq_tmp$x##3042 &gt;= 0}</span><span class='hs-varid'>name</span></a>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span>  <span class='hs-comment'>-- XXX: Putting the alternatives below in auxiliary functions would cause</span>
<span class=hs-linenum> 95: </span>  <span class='hs-comment'>-- a mysterious failure in LH.</span>
<span class=hs-linenum> 96: </span>  <span class='hs-conid'>ULam</span> <span class='hs-varid'>ty</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3092:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>maybeParens</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3065 : GHC.Types.Bool | lq_tmp$x##3065 &lt;=&gt; prec##adgj &gt;= Language.Stitch.LH.Pretty.lamPrec}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3082 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3082 == prec##adgj}</span><span class='hs-varid'>prec</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3084 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3084 == Language.Stitch.LH.Pretty.lamPrec}</span><span class='hs-varid'>lamPrec</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum> 97: </span>    <span class='hs-varid'>fillSep</span> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>char</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3096 : GHC.Types.Char | lq_tmp$x##3096 == ((lit "955" Char) : Char)}</span><span class='hs-chr'>'λ'</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>applyColor</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3142 : Language.Stitch.LH.Pretty.ScopedVar | is$Language.Stitch.LH.Pretty.ScopedVar lq_tmp$x##3142
                                                        &amp;&amp; lq_tmp$x##3142 == Language.Stitch.LH.Pretty.ScopedVar lq_anf$##7205759403792845794##ddzQ lq_anf$##7205759403792845796##ddzS
                                                        &amp;&amp; Language.Stitch.LH.Pretty.maxIndex lq_tmp$x##3142 == lq_anf$##7205759403792845794##ddzQ
                                                        &amp;&amp; Language.Stitch.LH.Pretty.scopedIndex lq_tmp$x##3142 == lq_anf$##7205759403792845796##ddzS}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>ScopedVar</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3126 : GHC.Types.Int | lq_tmp$x##3126 == n##adgi + lq_anf$##7205759403792845793##ddzP}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3129 : GHC.Types.Int | lq_tmp$x##3129 == n##adgi
                                  &amp;&amp; lq_tmp$x##3129 &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3110 : GHC.Types.Int | lq_tmp$x##3110 == (lq_anf$##7205759403792845792##ddzO : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3135 : GHC.Types.Int | lq_tmp$x##3135 == (lq_anf$##7205759403792845795##ddzR : int)}</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-layout'>(</span></a><span class='hs-varid'>char</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3151 : GHC.Types.Char | lq_tmp$x##3151 == ((lit "35" Char) : Char)}</span><span class='hs-chr'>'#'</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;&gt;</span>
<span class=hs-linenum> 98: </span>              <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3178 : [GHC.Types.Char] | len lq_tmp$x##3178 == strLen lq_anf$##7205759403792845801##ddzX
                                     &amp;&amp; lq_tmp$x##3178 ~~ lq_anf$##7205759403792845801##ddzX}</span><span class='hs-str'>":"</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>pretty</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3210 : Language.Stitch.LH.Type.Ty | lq_tmp$x##3210 == ty##adgm}</span><span class='hs-varid'>ty</span></a> <span class='hs-varop'>&lt;&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>char</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3213 : GHC.Types.Char | lq_tmp$x##3213 == ((lit "46" Char) : Char)}</span><span class='hs-chr'>'.'</span></a>
<span class=hs-linenum> 99: </span>            <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3311 : GHC.Types.Int | lq_tmp$x##3311 == n##adgi + lq_anf$##7205759403792845812##ddA8}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3314 : GHC.Types.Int | lq_tmp$x##3314 == n##adgi
                                  &amp;&amp; lq_tmp$x##3314 &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3295 : GHC.Types.Int | lq_tmp$x##3295 == (lq_anf$##7205759403792845811##ddA7 : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3330 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3330 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3331 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##3331 == body##adgn
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##3331 &gt;= 0}</span><span class='hs-varid'>body</span></a> <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>100: </span>
<span class=hs-linenum>101: </span>  <span class='hs-conid'>UApp</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3493:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>maybeParens</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3466 : GHC.Types.Bool | lq_tmp$x##3466 &lt;=&gt; prec##adgj &gt;= Language.Stitch.LH.Pretty.appPrec}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3483 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3483 == prec##adgj}</span><span class='hs-varid'>prec</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3485 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3485 == Language.Stitch.LH.Pretty.appPrec}</span><span class='hs-varid'>appPrec</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>102: </span>    <span class='hs-varid'>fillSep</span> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3507 : GHC.Types.Int | lq_tmp$x##3507 == n##adgi
                                  &amp;&amp; lq_tmp$x##3507 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3509 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3509 == Language.Stitch.LH.Pretty.appLeftPrec}</span><span class='hs-varid'>appLeftPrec</span></a>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##3510 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##3510 == e1##adgo
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##3510 &gt;= 0}</span><span class='hs-varid'>e1</span></a>
<span class=hs-linenum>103: </span>            <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3523 : GHC.Types.Int | lq_tmp$x##3523 == n##adgi
                                  &amp;&amp; lq_tmp$x##3523 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3525 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3525 == Language.Stitch.LH.Pretty.appRightPrec}</span><span class='hs-varid'>appRightPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3526 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##3526 == e2##adgp
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##3526 &gt;= 0}</span><span class='hs-varid'>e2</span></a> <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span>  <span class='hs-conid'>ULet</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##3688:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>maybeParens</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3661 : GHC.Types.Bool | lq_tmp$x##3661 &lt;=&gt; prec##adgj &gt;= Language.Stitch.LH.Pretty.lamPrec}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3678 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3678 == prec##adgj}</span><span class='hs-varid'>prec</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3680 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3680 == Language.Stitch.LH.Pretty.lamPrec}</span><span class='hs-varid'>lamPrec</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>106: </span>    <span class='hs-varid'>fillSep</span> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3697 : [GHC.Types.Char] | len lq_tmp$x##3697 == strLen lq_anf$##7205759403792845829##ddAp
                                     &amp;&amp; lq_tmp$x##3697 ~~ lq_anf$##7205759403792845829##ddAp}</span><span class='hs-str'>"let"</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>applyColor</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3753 : Language.Stitch.LH.Pretty.ScopedVar | is$Language.Stitch.LH.Pretty.ScopedVar lq_tmp$x##3753
                                                        &amp;&amp; lq_tmp$x##3753 == Language.Stitch.LH.Pretty.ScopedVar lq_anf$##7205759403792845834##ddAu lq_anf$##7205759403792845836##ddAw
                                                        &amp;&amp; Language.Stitch.LH.Pretty.maxIndex lq_tmp$x##3753 == lq_anf$##7205759403792845834##ddAu
                                                        &amp;&amp; Language.Stitch.LH.Pretty.scopedIndex lq_tmp$x##3753 == lq_anf$##7205759403792845836##ddAw}</span><span class='hs-layout'>(</span></a><span class='hs-conid'>ScopedVar</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3737 : GHC.Types.Int | lq_tmp$x##3737 == n##adgi + lq_anf$##7205759403792845833##ddAt}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3740 : GHC.Types.Int | lq_tmp$x##3740 == n##adgi
                                  &amp;&amp; lq_tmp$x##3740 &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3721 : GHC.Types.Int | lq_tmp$x##3721 == (lq_anf$##7205759403792845832##ddAs : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3746 : GHC.Types.Int | lq_tmp$x##3746 == (lq_anf$##7205759403792845835##ddAv : int)}</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-layout'>(</span></a><span class='hs-varid'>char</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3762 : GHC.Types.Char | lq_tmp$x##3762 == ((lit "35" Char) : Char)}</span><span class='hs-chr'>'#'</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&lt;+&gt;</span>
<span class=hs-linenum>107: </span>              <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>char</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3784 : GHC.Types.Char | lq_tmp$x##3784 == ((lit "61" Char) : Char)}</span><span class='hs-chr'>'='</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3806 : GHC.Types.Int | lq_tmp$x##3806 == n##adgi
                                  &amp;&amp; lq_tmp$x##3806 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3808 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3808 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3809 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##3809 == e1##adgq
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##3809 &gt;= 0}</span><span class='hs-varid'>e1</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3817 : [GHC.Types.Char] | len lq_tmp$x##3817 == strLen lq_anf$##7205759403792845844##ddAE
                                     &amp;&amp; lq_tmp$x##3817 ~~ lq_anf$##7205759403792845844##ddAE}</span><span class='hs-str'>"in"</span></a>
<span class=hs-linenum>108: </span>            <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3897 : GHC.Types.Int | lq_tmp$x##3897 == n##adgi + lq_anf$##7205759403792845852##ddAM}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3900 : GHC.Types.Int | lq_tmp$x##3900 == n##adgi
                                  &amp;&amp; lq_tmp$x##3900 &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3881 : GHC.Types.Int | lq_tmp$x##3881 == (lq_anf$##7205759403792845851##ddAL : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3916 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3916 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3917 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##3917 == e2##adgr
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##3917 &gt;= 0}</span><span class='hs-varid'>e2</span></a> <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>109: </span>
<span class=hs-linenum>110: </span>  <span class='hs-conid'>UArith</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>op</span> <span class='hs-varid'>e2</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4092:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>maybeParens</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4065 : GHC.Types.Bool | lq_tmp$x##4065 &lt;=&gt; prec##adgj &gt;= lq_anf$##7205759403792845859##ddAT}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4082 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4082 == prec##adgj}</span><span class='hs-varid'>prec</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-varid'>opPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4059 : Language.Stitch.LH.Op.ArithOp | Language.Stitch.LH.Op.arithType lq_tmp$x##4059 == Language.Stitch.LH.Type.TBool
                                                  || Language.Stitch.LH.Op.arithType lq_tmp$x##4059 == Language.Stitch.LH.Type.TInt
                                                  &amp;&amp; lq_tmp$x##4059 == op##adgt}</span><span class='hs-varid'>op</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>111: </span>    <span class='hs-varid'>fillSep</span> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4113 : GHC.Types.Int | lq_tmp$x##4113 == n##adgi
                                  &amp;&amp; lq_tmp$x##4113 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>opLeftPrec</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4100 : Language.Stitch.LH.Op.ArithOp | Language.Stitch.LH.Op.arithType lq_tmp$x##4100 == Language.Stitch.LH.Type.TBool
                                                  || Language.Stitch.LH.Op.arithType lq_tmp$x##4100 == Language.Stitch.LH.Type.TInt
                                                  &amp;&amp; lq_tmp$x##4100 == op##adgt}</span><span class='hs-varid'>op</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4116 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4116 == e1##adgs
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4116 &gt;= 0}</span><span class='hs-varid'>e1</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>pretty</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4129 : Language.Stitch.LH.Op.ArithOp | Language.Stitch.LH.Op.arithType lq_tmp$x##4129 == Language.Stitch.LH.Type.TBool
                                                  || Language.Stitch.LH.Op.arithType lq_tmp$x##4129 == Language.Stitch.LH.Type.TInt
                                                  &amp;&amp; lq_tmp$x##4129 == op##adgt}</span><span class='hs-varid'>op</span></a>
<span class=hs-linenum>112: </span>            <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4159 : GHC.Types.Int | lq_tmp$x##4159 == n##adgi
                                  &amp;&amp; lq_tmp$x##4159 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>opRightPrec</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4146 : Language.Stitch.LH.Op.ArithOp | Language.Stitch.LH.Op.arithType lq_tmp$x##4146 == Language.Stitch.LH.Type.TBool
                                                  || Language.Stitch.LH.Op.arithType lq_tmp$x##4146 == Language.Stitch.LH.Type.TInt
                                                  &amp;&amp; lq_tmp$x##4146 == op##adgt}</span><span class='hs-varid'>op</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4162 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4162 == e2##adgu
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4162 &gt;= 0}</span><span class='hs-varid'>e2</span></a> <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>113: </span>
<span class=hs-linenum>114: </span>  <span class='hs-conid'>UCond</span> <span class='hs-varid'>e1</span> <span class='hs-varid'>e2</span> <span class='hs-varid'>e3</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4330:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>maybeParens</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4303 : GHC.Types.Bool | lq_tmp$x##4303 &lt;=&gt; prec##adgj &gt;= Language.Stitch.LH.Pretty.ifPrec}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4320 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4320 == prec##adgj}</span><span class='hs-varid'>prec</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4322 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4322 == Language.Stitch.LH.Pretty.ifPrec}</span><span class='hs-varid'>ifPrec</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>115: </span>    <span class='hs-varid'>fillSep</span> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4339 : [GHC.Types.Char] | len lq_tmp$x##4339 == strLen lq_anf$##7205759403792845874##ddB8
                                     &amp;&amp; lq_tmp$x##4339 ~~ lq_anf$##7205759403792845874##ddB8}</span><span class='hs-str'>"if"</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4371 : GHC.Types.Int | lq_tmp$x##4371 == n##adgi
                                  &amp;&amp; lq_tmp$x##4371 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4373 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4373 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4374 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4374 == e1##adgv
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4374 &gt;= 0}</span><span class='hs-varid'>e1</span></a>
<span class=hs-linenum>116: </span>            <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4392 : [GHC.Types.Char] | len lq_tmp$x##4392 == strLen lq_anf$##7205759403792845879##ddBd
                                     &amp;&amp; lq_tmp$x##4392 ~~ lq_anf$##7205759403792845879##ddBd}</span><span class='hs-str'>"then"</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4424 : GHC.Types.Int | lq_tmp$x##4424 == n##adgi
                                  &amp;&amp; lq_tmp$x##4424 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4426 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4426 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4427 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4427 == e2##adgw
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4427 &gt;= 0}</span><span class='hs-varid'>e2</span></a>
<span class=hs-linenum>117: </span>            <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4445 : [GHC.Types.Char] | len lq_tmp$x##4445 == strLen lq_anf$##7205759403792845884##ddBi
                                     &amp;&amp; lq_tmp$x##4445 ~~ lq_anf$##7205759403792845884##ddBi}</span><span class='hs-str'>"else"</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4477 : GHC.Types.Int | lq_tmp$x##4477 == n##adgi
                                  &amp;&amp; lq_tmp$x##4477 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4479 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4479 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4480 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4480 == e3##adgx
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4480 &gt;= 0}</span><span class='hs-varid'>e3</span></a> <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span>  <span class='hs-conid'>UFix</span> <span class='hs-varid'>body</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4676:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>maybeParens</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4649 : GHC.Types.Bool | lq_tmp$x##4649 &lt;=&gt; prec##adgj &gt;= Language.Stitch.LH.Pretty.appPrec}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4666 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4666 == prec##adgj}</span><span class='hs-varid'>prec</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4668 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4668 == Language.Stitch.LH.Pretty.appPrec}</span><span class='hs-varid'>appPrec</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span>
<span class=hs-linenum>120: </span>                 <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4685 : [GHC.Types.Char] | len lq_tmp$x##4685 == strLen lq_anf$##7205759403792845896##ddBu
                                     &amp;&amp; lq_tmp$x##4685 ~~ lq_anf$##7205759403792845896##ddBu}</span><span class='hs-str'>"fix"</span></a> <span class='hs-varop'>&lt;+&gt;</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>prettyExp</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4717 : GHC.Types.Int | lq_tmp$x##4717 == n##adgi
                                  &amp;&amp; lq_tmp$x##4717 &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4719 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##4719 == Language.Stitch.LH.Util.topPrec}</span><span class='hs-varid'>topPrec</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4720 : Language.Stitch.LH.Unchecked.UExp | lq_tmp$x##4720 == body##adgy
                                                      &amp;&amp; Language.Stitch.LH.Unchecked.numFreeVars lq_tmp$x##4720 &gt;= 0}</span><span class='hs-varid'>body</span></a>
<span class=hs-linenum>121: </span>
<span class=hs-linenum>122: </span>  <span class='hs-conid'>UIntE</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4770:GHC.Types.Int -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>int</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4771 : GHC.Types.Int | lq_tmp$x##4771 == i##adgz}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>123: </span>
<span class=hs-linenum>124: </span>  <span class='hs-conid'>UBoolE</span> <span class='hs-conid'>True</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4840:[GHC.Types.Char] -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4827 : [GHC.Types.Char] | len lq_tmp$x##4827 == strLen lq_anf$##7205759403792845904##ddBC
                                     &amp;&amp; lq_tmp$x##4827 ~~ lq_anf$##7205759403792845904##ddBC}</span><span class='hs-str'>"true"</span></a>
<span class=hs-linenum>125: </span>
<span class=hs-linenum>126: </span>  <span class='hs-conid'>UBoolE</span> <span class='hs-conid'>False</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4809:[GHC.Types.Char] -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>text</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4796 : [GHC.Types.Char] | len lq_tmp$x##4796 == strLen lq_anf$##7205759403792845902##ddBA
                                     &amp;&amp; lq_tmp$x##4796 ~~ lq_anf$##7205759403792845902##ddBA}</span><span class='hs-str'>"false"</span></a>
</pre>
</body>
</html>