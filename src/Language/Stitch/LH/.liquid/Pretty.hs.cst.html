<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Language/Stitch/LH/Pretty.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##1234 : GHC.Types.Module | $k_##1235}</span><span class='hs-comment'>{-# LANGUAGE ViewPatterns #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# OPTIONS_GHC -fplugin=LiquidHaskell #-}</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<span class=hs-linenum> 5: </span><span class='hs-comment'>-- |</span>
<span class=hs-linenum> 6: </span><span class='hs-comment'>-- Module      :  Language.Stitch.LH.Pretty</span>
<span class=hs-linenum> 7: </span><span class='hs-comment'>-- Copyright   :  (C) 2015 Richard Eisenberg</span>
<span class=hs-linenum> 8: </span><span class='hs-comment'>-- License     :  BSD-style (see LICENSE)</span>
<span class=hs-linenum> 9: </span><span class='hs-comment'>-- Maintainer  :  Richard Eisenberg (rae@richarde.dev)</span>
<span class=hs-linenum>10: </span><span class='hs-comment'>-- Stability   :  experimental</span>
<span class=hs-linenum>11: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>12: </span><span class='hs-comment'>-- Helpers for prettyprinting expressions.</span>
<span class=hs-linenum>13: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>14: </span><span class='hs-comment'>----------------------------------------------------------------------------</span>
<span class=hs-linenum>15: </span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Language.Stitch.LH.Pretty</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>17: </span>
<span class=hs-linenum>18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Op</span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Util</span>
<span class=hs-linenum>20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Data.Nat</span>
<span class=hs-linenum>21: </span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.PrettyPrint.ANSI.Leijen</span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-definition'>lamPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appLeftPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appRightPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifPrec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Prec</span>
<span class=hs-linenum>25: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>lamPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum>26: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>9</span>
<span class=hs-linenum>27: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appLeftPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8.9</span>
<span class=hs-linenum>28: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appRightPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>9</span>
<span class=hs-linenum>29: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>ifPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum>30: </span>
<span class=hs-linenum>31: </span><span class='hs-definition'>opPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>opLeftPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>opRightPrec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArithOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prec</span>
<span class=hs-linenum>32: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2945:Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opPrec</span></a>      <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3046 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3046 == x##acEx}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>33: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2842:Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opLeftPrec</span></a>  <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2943 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2943 == x##acEy}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>34: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2739:Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opRightPrec</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2840 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2840 == x##acEz}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>35: </span>
<span class=hs-linenum>36: </span><span class='hs-comment'>-- | Returns (overall, left, right) precedences for an 'ArithOp'</span>
<span class=hs-linenum>37: </span><span class='hs-definition'>precInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArithOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Prec</span><span class='hs-layout'>,</span> <span class='hs-conid'>Prec</span><span class='hs-layout'>,</span> <span class='hs-conid'>Prec</span><span class='hs-layout'>)</span>
<span class=hs-linenum>38: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1491:Language.Stitch.LH.Op.ArithOp -&gt; ((GHC.Real.Ratio GHC.Integer.Type.Integer), (GHC.Real.Ratio GHC.Integer.Type.Integer), (GHC.Real.Ratio GHC.Integer.Type.Integer))</span><span class='hs-definition'>precInfo</span></a> <span class='hs-conid'>Plus</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1587:a -&gt; lq_tmp$x##1588:{lq_tmp$x##1573 : b&lt;p2 lq_tmp$x##1587&gt; | true} -&gt; lq_tmp$x##1589:{lq_tmp$x##1574 : c&lt;p3 lq_tmp$x##1588 lq_tmp$x##1587&gt; | true} -&gt; {lq_tmp$x##1583 : (a, b, c)&lt;\lq_tmp$x##1590 VV -&gt; {lq_tmp$x##1579 : b&lt;p2 lq_tmp$x##1590&gt; | true}, \lq_tmp$x##1591 lq_tmp$x##1592 VV -&gt; {lq_tmp$x##1582 : c&lt;p3 lq_tmp$x##1591 lq_tmp$x##1592&gt; | true}&gt; | x_Tuple31 lq_tmp$x##1583 == lq_tmp$x##1587
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1583 == lq_tmp$x##1588
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##1583 == lq_tmp$x##1589} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1514 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1514 == lq_anf$##7205759403792842623##dcKH}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1566 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1566 == lq_anf$##7205759403792842629##dcKN}</span><span class='hs-num'>5</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>39: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Minus</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1720:a -&gt; lq_tmp$x##1721:{lq_tmp$x##1706 : b&lt;p2 lq_tmp$x##1720&gt; | true} -&gt; lq_tmp$x##1722:{lq_tmp$x##1707 : c&lt;p3 lq_tmp$x##1721 lq_tmp$x##1720&gt; | true} -&gt; {lq_tmp$x##1716 : (a, b, c)&lt;\lq_tmp$x##1723 VV -&gt; {lq_tmp$x##1712 : b&lt;p2 lq_tmp$x##1723&gt; | true}, \lq_tmp$x##1724 lq_tmp$x##1725 VV -&gt; {lq_tmp$x##1715 : c&lt;p3 lq_tmp$x##1724 lq_tmp$x##1725&gt; | true}&gt; | x_Tuple31 lq_tmp$x##1716 == lq_tmp$x##1720
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1716 == lq_tmp$x##1721
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##1716 == lq_tmp$x##1722} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1647 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1647 == lq_anf$##7205759403792842631##dcKP}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1699 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1699 == lq_anf$##7205759403792842637##dcKV}</span><span class='hs-num'>5</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>40: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Times</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1853:a -&gt; lq_tmp$x##1854:{lq_tmp$x##1839 : b&lt;p2 lq_tmp$x##1853&gt; | true} -&gt; lq_tmp$x##1855:{lq_tmp$x##1840 : c&lt;p3 lq_tmp$x##1854 lq_tmp$x##1853&gt; | true} -&gt; {lq_tmp$x##1849 : (a, b, c)&lt;\lq_tmp$x##1856 VV -&gt; {lq_tmp$x##1845 : b&lt;p2 lq_tmp$x##1856&gt; | true}, \lq_tmp$x##1857 lq_tmp$x##1858 VV -&gt; {lq_tmp$x##1848 : c&lt;p3 lq_tmp$x##1857 lq_tmp$x##1858&gt; | true}&gt; | x_Tuple31 lq_tmp$x##1849 == lq_tmp$x##1853
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1849 == lq_tmp$x##1854
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##1849 == lq_tmp$x##1855} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1780 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1780 == lq_anf$##7205759403792842639##dcKX}</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1832 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1832 == lq_anf$##7205759403792842645##dcL3}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>41: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Divide</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1986:a -&gt; lq_tmp$x##1987:{lq_tmp$x##1972 : b&lt;p2 lq_tmp$x##1986&gt; | true} -&gt; lq_tmp$x##1988:{lq_tmp$x##1973 : c&lt;p3 lq_tmp$x##1987 lq_tmp$x##1986&gt; | true} -&gt; {lq_tmp$x##1982 : (a, b, c)&lt;\lq_tmp$x##1989 VV -&gt; {lq_tmp$x##1978 : b&lt;p2 lq_tmp$x##1989&gt; | true}, \lq_tmp$x##1990 lq_tmp$x##1991 VV -&gt; {lq_tmp$x##1981 : c&lt;p3 lq_tmp$x##1990 lq_tmp$x##1991&gt; | true}&gt; | x_Tuple31 lq_tmp$x##1982 == lq_tmp$x##1986
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1982 == lq_tmp$x##1987
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##1982 == lq_tmp$x##1988} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1913 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1913 == lq_anf$##7205759403792842647##dcL5}</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1965 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1965 == lq_anf$##7205759403792842653##dcLb}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>42: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Mod</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2119:a -&gt; lq_tmp$x##2120:{lq_tmp$x##2105 : b&lt;p2 lq_tmp$x##2119&gt; | true} -&gt; lq_tmp$x##2121:{lq_tmp$x##2106 : c&lt;p3 lq_tmp$x##2120 lq_tmp$x##2119&gt; | true} -&gt; {lq_tmp$x##2115 : (a, b, c)&lt;\lq_tmp$x##2122 VV -&gt; {lq_tmp$x##2111 : b&lt;p2 lq_tmp$x##2122&gt; | true}, \lq_tmp$x##2123 lq_tmp$x##2124 VV -&gt; {lq_tmp$x##2114 : c&lt;p3 lq_tmp$x##2123 lq_tmp$x##2124&gt; | true}&gt; | x_Tuple31 lq_tmp$x##2115 == lq_tmp$x##2119
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2115 == lq_tmp$x##2120
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##2115 == lq_tmp$x##2121} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2046 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2046 == lq_anf$##7205759403792842655##dcLd}</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2098 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2098 == lq_anf$##7205759403792842661##dcLj}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>43: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Less</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2234:a -&gt; lq_tmp$x##2235:{lq_tmp$x##2220 : b&lt;p2 lq_tmp$x##2234&gt; | true} -&gt; lq_tmp$x##2236:{lq_tmp$x##2221 : c&lt;p3 lq_tmp$x##2235 lq_tmp$x##2234&gt; | true} -&gt; {lq_tmp$x##2230 : (a, b, c)&lt;\lq_tmp$x##2237 VV -&gt; {lq_tmp$x##2226 : b&lt;p2 lq_tmp$x##2237&gt; | true}, \lq_tmp$x##2238 lq_tmp$x##2239 VV -&gt; {lq_tmp$x##2229 : c&lt;p3 lq_tmp$x##2238 lq_tmp$x##2239&gt; | true}&gt; | x_Tuple31 lq_tmp$x##2230 == lq_tmp$x##2234
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2230 == lq_tmp$x##2235
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##2230 == lq_tmp$x##2236} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2179 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2179 == lq_anf$##7205759403792842663##dcLl}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2196 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2196 == lq_anf$##7205759403792842665##dcLn}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2213 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2213 == lq_anf$##7205759403792842667##dcLp}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>44: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>LessE</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2349:a -&gt; lq_tmp$x##2350:{lq_tmp$x##2335 : b&lt;p2 lq_tmp$x##2349&gt; | true} -&gt; lq_tmp$x##2351:{lq_tmp$x##2336 : c&lt;p3 lq_tmp$x##2350 lq_tmp$x##2349&gt; | true} -&gt; {lq_tmp$x##2345 : (a, b, c)&lt;\lq_tmp$x##2352 VV -&gt; {lq_tmp$x##2341 : b&lt;p2 lq_tmp$x##2352&gt; | true}, \lq_tmp$x##2353 lq_tmp$x##2354 VV -&gt; {lq_tmp$x##2344 : c&lt;p3 lq_tmp$x##2353 lq_tmp$x##2354&gt; | true}&gt; | x_Tuple31 lq_tmp$x##2345 == lq_tmp$x##2349
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2345 == lq_tmp$x##2350
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##2345 == lq_tmp$x##2351} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2294 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2294 == lq_anf$##7205759403792842669##dcLr}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2311 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2311 == lq_anf$##7205759403792842671##dcLt}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2328 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2328 == lq_anf$##7205759403792842673##dcLv}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>45: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Greater</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2464:a -&gt; lq_tmp$x##2465:{lq_tmp$x##2450 : b&lt;p2 lq_tmp$x##2464&gt; | true} -&gt; lq_tmp$x##2466:{lq_tmp$x##2451 : c&lt;p3 lq_tmp$x##2465 lq_tmp$x##2464&gt; | true} -&gt; {lq_tmp$x##2460 : (a, b, c)&lt;\lq_tmp$x##2467 VV -&gt; {lq_tmp$x##2456 : b&lt;p2 lq_tmp$x##2467&gt; | true}, \lq_tmp$x##2468 lq_tmp$x##2469 VV -&gt; {lq_tmp$x##2459 : c&lt;p3 lq_tmp$x##2468 lq_tmp$x##2469&gt; | true}&gt; | x_Tuple31 lq_tmp$x##2460 == lq_tmp$x##2464
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2460 == lq_tmp$x##2465
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##2460 == lq_tmp$x##2466} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2409 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2409 == lq_anf$##7205759403792842675##dcLx}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2426 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2426 == lq_anf$##7205759403792842677##dcLz}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2443 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2443 == lq_anf$##7205759403792842679##dcLB}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>46: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>GreaterE</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2579:a -&gt; lq_tmp$x##2580:{lq_tmp$x##2565 : b&lt;p2 lq_tmp$x##2579&gt; | true} -&gt; lq_tmp$x##2581:{lq_tmp$x##2566 : c&lt;p3 lq_tmp$x##2580 lq_tmp$x##2579&gt; | true} -&gt; {lq_tmp$x##2575 : (a, b, c)&lt;\lq_tmp$x##2582 VV -&gt; {lq_tmp$x##2571 : b&lt;p2 lq_tmp$x##2582&gt; | true}, \lq_tmp$x##2583 lq_tmp$x##2584 VV -&gt; {lq_tmp$x##2574 : c&lt;p3 lq_tmp$x##2583 lq_tmp$x##2584&gt; | true}&gt; | x_Tuple31 lq_tmp$x##2575 == lq_tmp$x##2579
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2575 == lq_tmp$x##2580
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##2575 == lq_tmp$x##2581} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2524 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2524 == lq_anf$##7205759403792842681##dcLD}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2541 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2541 == lq_anf$##7205759403792842683##dcLF}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2558 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2558 == lq_anf$##7205759403792842685##dcLH}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>47: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Equals</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2694:a -&gt; lq_tmp$x##2695:{lq_tmp$x##2680 : b&lt;p2 lq_tmp$x##2694&gt; | true} -&gt; lq_tmp$x##2696:{lq_tmp$x##2681 : c&lt;p3 lq_tmp$x##2695 lq_tmp$x##2694&gt; | true} -&gt; {lq_tmp$x##2690 : (a, b, c)&lt;\lq_tmp$x##2697 VV -&gt; {lq_tmp$x##2686 : b&lt;p2 lq_tmp$x##2697&gt; | true}, \lq_tmp$x##2698 lq_tmp$x##2699 VV -&gt; {lq_tmp$x##2689 : c&lt;p3 lq_tmp$x##2698 lq_tmp$x##2699&gt; | true}&gt; | x_Tuple31 lq_tmp$x##2690 == lq_tmp$x##2694
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2690 == lq_tmp$x##2695
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple33 lq_tmp$x##2690 == lq_tmp$x##2696} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2639 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2639 == lq_anf$##7205759403792842687##dcLJ}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2656 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2656 == lq_anf$##7205759403792842689##dcLL}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2673 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2673 == lq_anf$##7205759403792842691##dcLN}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>48: </span>
<span class=hs-linenum>49: </span><span class='hs-comment'>-- | A function that changes a 'Doc's color</span>
<span class=hs-linenum>50: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>ApplyColor</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Doc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Doc</span>
<span class=hs-linenum>51: </span>
<span class=hs-linenum>52: </span><span class='hs-comment'>-- | The colors used for all rendered expressions</span>
<span class=hs-linenum>53: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>coloring</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ v :</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ApplyColor</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len v &gt; 0 }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>54: </span><span class='hs-definition'>coloring</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ApplyColor</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>55: </span><a class=annot href="#"><span class=annottext>{v : [Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc] | len v &gt; 0}</span><span class='hs-definition'>coloring</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1223:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>red</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1178:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>green</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1133:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>yellow</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1088:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>blue</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1043:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>magenta</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##998:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>cyan</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>56: </span>
<span class=hs-linenum>57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>applyColor</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>58: </span><span class='hs-comment'>-- LH would need a proof that</span>
<span class=hs-linenum>59: </span><span class='hs-comment'>-- @len (cycle coloring) &gt; maxIndex v - scopedIndex v@</span>
<span class=hs-linenum>60: </span><span class='hs-comment'>-- so @!!@ is safe to use.</span>
<span class=hs-linenum>61: </span><span class='hs-definition'>applyColor</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ApplyColor</span>
<span class=hs-linenum>62: </span><span class='hs-definition'>applyColor</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cycle</span> <span class='hs-varid'>coloring</span> <span class='hs-varop'>!!</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxIndex</span> <span class='hs-varid'>v</span> <span class='hs-comment'>-</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>63: </span>
<span class=hs-linenum>64: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>65: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedVar</span>
<span class=hs-linenum>66: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>maxIndex</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span>
<span class=hs-linenum>67: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span> <span class='hs-varid'>i</span> <span class='hs-conop'>:</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>maxIndex</span> <span class='hs-layout'>}</span>
<span class=hs-linenum>68: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum>69: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>70: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedVar</span>
<span class=hs-linenum>71: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>maxIndex</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span>
<span class=hs-linenum>72: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum>73: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum>74: </span>
<span class=hs-linenum>75: </span><span class='hs-comment'>-- The number of variables in scope.</span>
<span class=hs-linenum>76: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>77: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nat</span>
</pre>
</body>
</html>