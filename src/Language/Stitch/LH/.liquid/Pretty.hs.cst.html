<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Language/Stitch/LH/Pretty.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##1232 : GHC.Types.Module | $k_##1233}</span><span class='hs-comment'>{-# LANGUAGE ViewPatterns #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# OPTIONS_GHC -fplugin=LiquidHaskell #-}</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<span class=hs-linenum> 5: </span><span class='hs-comment'>-- |</span>
<span class=hs-linenum> 6: </span><span class='hs-comment'>-- Module      :  Language.Stitch.LH.Pretty</span>
<span class=hs-linenum> 7: </span><span class='hs-comment'>-- Copyright   :  (C) 2015 Richard Eisenberg</span>
<span class=hs-linenum> 8: </span><span class='hs-comment'>-- License     :  BSD-style (see LICENSE)</span>
<span class=hs-linenum> 9: </span><span class='hs-comment'>-- Maintainer  :  Richard Eisenberg (rae@richarde.dev)</span>
<span class=hs-linenum>10: </span><span class='hs-comment'>-- Stability   :  experimental</span>
<span class=hs-linenum>11: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>12: </span><span class='hs-comment'>-- Helpers for prettyprinting expressions.</span>
<span class=hs-linenum>13: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>14: </span><span class='hs-comment'>----------------------------------------------------------------------------</span>
<span class=hs-linenum>15: </span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Language.Stitch.LH.Pretty</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>17: </span>
<span class=hs-linenum>18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Op</span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Util</span>
<span class=hs-linenum>20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Data.Nat</span>
<span class=hs-linenum>21: </span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.PrettyPrint.ANSI.Leijen</span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-definition'>lamPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appLeftPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appRightPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifPrec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Prec</span>
<span class=hs-linenum>25: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>lamPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum>26: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>9</span>
<span class=hs-linenum>27: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appLeftPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8.9</span>
<span class=hs-linenum>28: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appRightPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>9</span>
<span class=hs-linenum>29: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>ifPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum>30: </span>
<span class=hs-linenum>31: </span><span class='hs-definition'>opPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>opLeftPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>opRightPrec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArithOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prec</span>
<span class=hs-linenum>32: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2943:Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opPrec</span></a>      <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3044 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##3044 == x##aebj}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>33: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2840:Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opLeftPrec</span></a>  <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2941 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2941 == x##aebk}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>34: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##2737:Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opRightPrec</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2838 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2838 == x##aebl}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>35: </span>
<span class=hs-linenum>36: </span><span class='hs-comment'>-- | Returns (overall, left, right) precedences for an 'ArithOp'</span>
<span class=hs-linenum>37: </span><span class='hs-definition'>precInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArithOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Prec</span><span class='hs-layout'>,</span> <span class='hs-conid'>Prec</span><span class='hs-layout'>,</span> <span class='hs-conid'>Prec</span><span class='hs-layout'>)</span>
<span class=hs-linenum>38: </span><a class=annot href="#"><span class=annottext>lq_tmp$x##1489:Language.Stitch.LH.Op.ArithOp -&gt; ((GHC.Real.Ratio GHC.Integer.Type.Integer), (GHC.Real.Ratio GHC.Integer.Type.Integer), (GHC.Real.Ratio GHC.Integer.Type.Integer))</span><span class='hs-definition'>precInfo</span></a> <span class='hs-conid'>Plus</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1585:a -&gt; lq_tmp$x##1586:{lq_tmp$x##1571 : b&lt;p2 lq_tmp$x##1585&gt; | true} -&gt; lq_tmp$x##1587:{lq_tmp$x##1572 : c&lt;p3 lq_tmp$x##1586 lq_tmp$x##1585&gt; | true} -&gt; {lq_tmp$x##1581 : (a, b, c)&lt;\lq_tmp$x##1588 VV -&gt; {lq_tmp$x##1577 : b&lt;p2 lq_tmp$x##1588&gt; | true}, \lq_tmp$x##1589 lq_tmp$x##1590 VV -&gt; {lq_tmp$x##1580 : c&lt;p3 lq_tmp$x##1589 lq_tmp$x##1590&gt; | true}&gt; | x_Tuple33 lq_tmp$x##1581 == lq_tmp$x##1587
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1581 == lq_tmp$x##1586
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##1581 == lq_tmp$x##1585} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1512 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1512 == lq_anf$##7205759403792848484##dehe}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1564 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1564 == lq_anf$##7205759403792848490##dehk}</span><span class='hs-num'>5</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>39: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Minus</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1718:a -&gt; lq_tmp$x##1719:{lq_tmp$x##1704 : b&lt;p2 lq_tmp$x##1718&gt; | true} -&gt; lq_tmp$x##1720:{lq_tmp$x##1705 : c&lt;p3 lq_tmp$x##1719 lq_tmp$x##1718&gt; | true} -&gt; {lq_tmp$x##1714 : (a, b, c)&lt;\lq_tmp$x##1721 VV -&gt; {lq_tmp$x##1710 : b&lt;p2 lq_tmp$x##1721&gt; | true}, \lq_tmp$x##1722 lq_tmp$x##1723 VV -&gt; {lq_tmp$x##1713 : c&lt;p3 lq_tmp$x##1722 lq_tmp$x##1723&gt; | true}&gt; | x_Tuple33 lq_tmp$x##1714 == lq_tmp$x##1720
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1714 == lq_tmp$x##1719
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##1714 == lq_tmp$x##1718} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1645 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1645 == lq_anf$##7205759403792848492##dehm}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1697 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1697 == lq_anf$##7205759403792848498##dehs}</span><span class='hs-num'>5</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>40: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Times</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1851:a -&gt; lq_tmp$x##1852:{lq_tmp$x##1837 : b&lt;p2 lq_tmp$x##1851&gt; | true} -&gt; lq_tmp$x##1853:{lq_tmp$x##1838 : c&lt;p3 lq_tmp$x##1852 lq_tmp$x##1851&gt; | true} -&gt; {lq_tmp$x##1847 : (a, b, c)&lt;\lq_tmp$x##1854 VV -&gt; {lq_tmp$x##1843 : b&lt;p2 lq_tmp$x##1854&gt; | true}, \lq_tmp$x##1855 lq_tmp$x##1856 VV -&gt; {lq_tmp$x##1846 : c&lt;p3 lq_tmp$x##1855 lq_tmp$x##1856&gt; | true}&gt; | x_Tuple33 lq_tmp$x##1847 == lq_tmp$x##1853
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1847 == lq_tmp$x##1852
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##1847 == lq_tmp$x##1851} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1778 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1778 == lq_anf$##7205759403792848500##dehu}</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1830 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1830 == lq_anf$##7205759403792848506##dehA}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>41: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Divide</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##1984:a -&gt; lq_tmp$x##1985:{lq_tmp$x##1970 : b&lt;p2 lq_tmp$x##1984&gt; | true} -&gt; lq_tmp$x##1986:{lq_tmp$x##1971 : c&lt;p3 lq_tmp$x##1985 lq_tmp$x##1984&gt; | true} -&gt; {lq_tmp$x##1980 : (a, b, c)&lt;\lq_tmp$x##1987 VV -&gt; {lq_tmp$x##1976 : b&lt;p2 lq_tmp$x##1987&gt; | true}, \lq_tmp$x##1988 lq_tmp$x##1989 VV -&gt; {lq_tmp$x##1979 : c&lt;p3 lq_tmp$x##1988 lq_tmp$x##1989&gt; | true}&gt; | x_Tuple33 lq_tmp$x##1980 == lq_tmp$x##1986
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##1980 == lq_tmp$x##1985
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##1980 == lq_tmp$x##1984} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1911 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1911 == lq_anf$##7205759403792848508##dehC}</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1963 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##1963 == lq_anf$##7205759403792848514##dehI}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>42: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Mod</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2117:a -&gt; lq_tmp$x##2118:{lq_tmp$x##2103 : b&lt;p2 lq_tmp$x##2117&gt; | true} -&gt; lq_tmp$x##2119:{lq_tmp$x##2104 : c&lt;p3 lq_tmp$x##2118 lq_tmp$x##2117&gt; | true} -&gt; {lq_tmp$x##2113 : (a, b, c)&lt;\lq_tmp$x##2120 VV -&gt; {lq_tmp$x##2109 : b&lt;p2 lq_tmp$x##2120&gt; | true}, \lq_tmp$x##2121 lq_tmp$x##2122 VV -&gt; {lq_tmp$x##2112 : c&lt;p3 lq_tmp$x##2121 lq_tmp$x##2122&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2113 == lq_tmp$x##2119
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2113 == lq_tmp$x##2118
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##2113 == lq_tmp$x##2117} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2044 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2044 == lq_anf$##7205759403792848516##dehK}</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2096 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2096 == lq_anf$##7205759403792848522##dehQ}</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>43: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Less</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2232:a -&gt; lq_tmp$x##2233:{lq_tmp$x##2218 : b&lt;p2 lq_tmp$x##2232&gt; | true} -&gt; lq_tmp$x##2234:{lq_tmp$x##2219 : c&lt;p3 lq_tmp$x##2233 lq_tmp$x##2232&gt; | true} -&gt; {lq_tmp$x##2228 : (a, b, c)&lt;\lq_tmp$x##2235 VV -&gt; {lq_tmp$x##2224 : b&lt;p2 lq_tmp$x##2235&gt; | true}, \lq_tmp$x##2236 lq_tmp$x##2237 VV -&gt; {lq_tmp$x##2227 : c&lt;p3 lq_tmp$x##2236 lq_tmp$x##2237&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2228 == lq_tmp$x##2234
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2228 == lq_tmp$x##2233
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##2228 == lq_tmp$x##2232} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2177 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2177 == lq_anf$##7205759403792848524##dehS}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2194 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2194 == lq_anf$##7205759403792848526##dehU}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2211 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2211 == lq_anf$##7205759403792848528##dehW}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>44: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>LessE</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2347:a -&gt; lq_tmp$x##2348:{lq_tmp$x##2333 : b&lt;p2 lq_tmp$x##2347&gt; | true} -&gt; lq_tmp$x##2349:{lq_tmp$x##2334 : c&lt;p3 lq_tmp$x##2348 lq_tmp$x##2347&gt; | true} -&gt; {lq_tmp$x##2343 : (a, b, c)&lt;\lq_tmp$x##2350 VV -&gt; {lq_tmp$x##2339 : b&lt;p2 lq_tmp$x##2350&gt; | true}, \lq_tmp$x##2351 lq_tmp$x##2352 VV -&gt; {lq_tmp$x##2342 : c&lt;p3 lq_tmp$x##2351 lq_tmp$x##2352&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2343 == lq_tmp$x##2349
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2343 == lq_tmp$x##2348
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##2343 == lq_tmp$x##2347} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2292 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2292 == lq_anf$##7205759403792848530##dehY}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2309 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2309 == lq_anf$##7205759403792848532##dei0}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2326 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2326 == lq_anf$##7205759403792848534##dei2}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>45: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Greater</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2462:a -&gt; lq_tmp$x##2463:{lq_tmp$x##2448 : b&lt;p2 lq_tmp$x##2462&gt; | true} -&gt; lq_tmp$x##2464:{lq_tmp$x##2449 : c&lt;p3 lq_tmp$x##2463 lq_tmp$x##2462&gt; | true} -&gt; {lq_tmp$x##2458 : (a, b, c)&lt;\lq_tmp$x##2465 VV -&gt; {lq_tmp$x##2454 : b&lt;p2 lq_tmp$x##2465&gt; | true}, \lq_tmp$x##2466 lq_tmp$x##2467 VV -&gt; {lq_tmp$x##2457 : c&lt;p3 lq_tmp$x##2466 lq_tmp$x##2467&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2458 == lq_tmp$x##2464
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2458 == lq_tmp$x##2463
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##2458 == lq_tmp$x##2462} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2407 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2407 == lq_anf$##7205759403792848536##dei4}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2424 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2424 == lq_anf$##7205759403792848538##dei6}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2441 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2441 == lq_anf$##7205759403792848540##dei8}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>46: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>GreaterE</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2577:a -&gt; lq_tmp$x##2578:{lq_tmp$x##2563 : b&lt;p2 lq_tmp$x##2577&gt; | true} -&gt; lq_tmp$x##2579:{lq_tmp$x##2564 : c&lt;p3 lq_tmp$x##2578 lq_tmp$x##2577&gt; | true} -&gt; {lq_tmp$x##2573 : (a, b, c)&lt;\lq_tmp$x##2580 VV -&gt; {lq_tmp$x##2569 : b&lt;p2 lq_tmp$x##2580&gt; | true}, \lq_tmp$x##2581 lq_tmp$x##2582 VV -&gt; {lq_tmp$x##2572 : c&lt;p3 lq_tmp$x##2581 lq_tmp$x##2582&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2573 == lq_tmp$x##2579
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2573 == lq_tmp$x##2578
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##2573 == lq_tmp$x##2577} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2522 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2522 == lq_anf$##7205759403792848542##deia}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2539 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2539 == lq_anf$##7205759403792848544##deic}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2556 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2556 == lq_anf$##7205759403792848546##deie}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>47: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Equals</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2692:a -&gt; lq_tmp$x##2693:{lq_tmp$x##2678 : b&lt;p2 lq_tmp$x##2692&gt; | true} -&gt; lq_tmp$x##2694:{lq_tmp$x##2679 : c&lt;p3 lq_tmp$x##2693 lq_tmp$x##2692&gt; | true} -&gt; {lq_tmp$x##2688 : (a, b, c)&lt;\lq_tmp$x##2695 VV -&gt; {lq_tmp$x##2684 : b&lt;p2 lq_tmp$x##2695&gt; | true}, \lq_tmp$x##2696 lq_tmp$x##2697 VV -&gt; {lq_tmp$x##2687 : c&lt;p3 lq_tmp$x##2696 lq_tmp$x##2697&gt; | true}&gt; | x_Tuple33 lq_tmp$x##2688 == lq_tmp$x##2694
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple32 lq_tmp$x##2688 == lq_tmp$x##2693
                                                                                                                                                                                                                                                                                                                                                                                   &amp;&amp; x_Tuple31 lq_tmp$x##2688 == lq_tmp$x##2692} | VV == GHC.Tuple.(,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2637 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2637 == lq_anf$##7205759403792848548##deig}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2654 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2654 == lq_anf$##7205759403792848550##deii}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2671 : (GHC.Real.Ratio GHC.Integer.Type.Integer) | lq_tmp$x##2671 == lq_anf$##7205759403792848552##deik}</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>48: </span>
<span class=hs-linenum>49: </span><span class='hs-comment'>-- | A function that changes a 'Doc's color</span>
<span class=hs-linenum>50: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>ApplyColor</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Doc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Doc</span>
<span class=hs-linenum>51: </span>
<span class=hs-linenum>52: </span><span class='hs-comment'>-- | The colors used for all rendered expressions</span>
<span class=hs-linenum>53: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>coloring</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ v :</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ApplyColor</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len v &gt; 0 }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>54: </span><span class='hs-definition'>coloring</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ApplyColor</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>55: </span><a class=annot href="#"><span class=annottext>{v : [Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc] | len v &gt; 0}</span><span class='hs-definition'>coloring</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><a class=annot href="#"><span class=annottext>lq_tmp$x##1221:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>red</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1176:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>green</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1131:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>yellow</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1086:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>blue</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##1041:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>magenta</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##996:Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>cyan</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>56: </span>
<span class=hs-linenum>57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>applyColor</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>58: </span><span class='hs-comment'>-- LH would need a proof that</span>
<span class=hs-linenum>59: </span><span class='hs-comment'>-- @len (cycle coloring) &gt; maxIndex v - scopedIndex v@</span>
<span class=hs-linenum>60: </span><span class='hs-comment'>-- so @!!@ is safe to use.</span>
<span class=hs-linenum>61: </span><span class='hs-definition'>applyColor</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ApplyColor</span>
<span class=hs-linenum>62: </span><span class='hs-definition'>applyColor</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cycle</span> <span class='hs-varid'>coloring</span> <span class='hs-varop'>!!</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxIndex</span> <span class='hs-varid'>v</span> <span class='hs-comment'>-</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>63: </span>
<span class=hs-linenum>64: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>65: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedVar</span>
<span class=hs-linenum>66: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>maxIndex</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span>
<span class=hs-linenum>67: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span> <span class='hs-varid'>i</span> <span class='hs-conop'>:</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>maxIndex</span> <span class='hs-layout'>}</span>
<span class=hs-linenum>68: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum>69: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>70: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedVar</span>
<span class=hs-linenum>71: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>maxIndex</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span>
<span class=hs-linenum>72: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum>73: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum>74: </span>
<span class=hs-linenum>75: </span><span class='hs-comment'>-- The number of variables in scope.</span>
<span class=hs-linenum>76: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>77: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nat</span>
</pre>
</body>
</html>