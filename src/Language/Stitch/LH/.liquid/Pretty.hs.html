<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Language/Stitch/LH/Pretty.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE ViewPatterns #-}</span></a>
<span class=hs-linenum> 2: </span><span class='hs-comment'>{-# OPTIONS_GHC -fplugin=LiquidHaskell #-}</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span><span class='hs-comment'>-----------------------------------------------------------------------------</span>
<span class=hs-linenum> 5: </span><span class='hs-comment'>-- |</span>
<span class=hs-linenum> 6: </span><span class='hs-comment'>-- Module      :  Language.Stitch.LH.Pretty</span>
<span class=hs-linenum> 7: </span><span class='hs-comment'>-- Copyright   :  (C) 2015 Richard Eisenberg</span>
<span class=hs-linenum> 8: </span><span class='hs-comment'>-- License     :  BSD-style (see LICENSE)</span>
<span class=hs-linenum> 9: </span><span class='hs-comment'>-- Maintainer  :  Richard Eisenberg (rae@richarde.dev)</span>
<span class=hs-linenum>10: </span><span class='hs-comment'>-- Stability   :  experimental</span>
<span class=hs-linenum>11: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>12: </span><span class='hs-comment'>-- Helpers for prettyprinting expressions.</span>
<span class=hs-linenum>13: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>14: </span><span class='hs-comment'>----------------------------------------------------------------------------</span>
<span class=hs-linenum>15: </span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Language.Stitch.LH.Pretty</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>17: </span>
<span class=hs-linenum>18: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Op</span>
<span class=hs-linenum>19: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Util</span>
<span class=hs-linenum>20: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Language.Stitch.LH.Data.Nat</span>
<span class=hs-linenum>21: </span>
<span class=hs-linenum>22: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Text.PrettyPrint.ANSI.Leijen</span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-definition'>lamPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appLeftPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>appRightPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>ifPrec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Prec</span>
<span class=hs-linenum>25: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>lamPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum>26: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>9</span>
<span class=hs-linenum>27: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appLeftPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>8.9</span>
<span class=hs-linenum>28: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>appRightPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>9</span>
<span class=hs-linenum>29: </span><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>ifPrec</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
<span class=hs-linenum>30: </span>
<span class=hs-linenum>31: </span><span class='hs-definition'>opPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>opLeftPrec</span><span class='hs-layout'>,</span> <span class='hs-varid'>opRightPrec</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArithOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Prec</span>
<span class=hs-linenum>32: </span><a class=annot href="#"><span class=annottext>Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opPrec</span></a>      <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>33: </span><a class=annot href="#"><span class=annottext>Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opLeftPrec</span></a>  <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>34: </span><a class=annot href="#"><span class=annottext>Language.Stitch.LH.Op.ArithOp -&gt; (GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-definition'>opRightPrec</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>precInfo</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-keyword'>_</span><span class='hs-layout'>,</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Ratio GHC.Integer.Type.Integer) | v == x}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>35: </span>
<span class=hs-linenum>36: </span><span class='hs-comment'>-- | Returns (overall, left, right) precedences for an 'ArithOp'</span>
<span class=hs-linenum>37: </span><span class='hs-definition'>precInfo</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ArithOp</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Prec</span><span class='hs-layout'>,</span> <span class='hs-conid'>Prec</span><span class='hs-layout'>,</span> <span class='hs-conid'>Prec</span><span class='hs-layout'>)</span>
<span class=hs-linenum>38: </span><a class=annot href="#"><span class=annottext>Language.Stitch.LH.Op.ArithOp -&gt; ((GHC.Real.Ratio GHC.Integer.Type.Integer), (GHC.Real.Ratio GHC.Integer.Type.Integer), (GHC.Real.Ratio GHC.Integer.Type.Integer))</span><span class='hs-definition'>precInfo</span></a> <span class='hs-conid'>Plus</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>39: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Minus</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>40: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Times</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>41: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Divide</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>42: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Mod</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>6</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>5.9</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>6</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>43: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Less</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>44: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>LessE</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>45: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Greater</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>46: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>GreaterE</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>47: </span><span class='hs-definition'>precInfo</span> <span class='hs-conid'>Equals</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b c &lt;p3 :: b-&gt; a c -&gt; Bool, p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; x3:{VV : c&lt;p3 x2 x1&gt; | true} -&gt; {v : (a, b, c)&lt;\x8 VV -&gt; {VV : b&lt;p2 x8&gt; | true}, \x8 x8 VV -&gt; {VV : c&lt;p3 x8 x8&gt; | true}&gt; | x_Tuple31 v == x1
                                                                                                                                                                      &amp;&amp; x_Tuple32 v == x2
                                                                                                                                                                      &amp;&amp; x_Tuple33 v == x3} | VV == (,,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(GHC.Real.Ratio GHC.Integer.Type.Integer)</span><span class='hs-num'>4</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>48: </span>
<span class=hs-linenum>49: </span><span class='hs-comment'>-- | A function that changes a 'Doc's color</span>
<span class=hs-linenum>50: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>ApplyColor</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Doc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Doc</span>
<span class=hs-linenum>51: </span>
<span class=hs-linenum>52: </span><span class='hs-comment'>-- | The colors used for all rendered expressions</span>
<span class=hs-linenum>53: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>coloring</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ v :</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ApplyColor</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| len v &gt; 0 }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>54: </span><span class='hs-definition'>coloring</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ApplyColor</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>55: </span><a class=annot href="#"><span class=annottext>{v : [Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc] | len v &gt; 0}</span><span class='hs-definition'>coloring</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>red</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>green</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>yellow</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>blue</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>magenta</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>Text.PrettyPrint.ANSI.Leijen.Internal.Doc -&gt; Text.PrettyPrint.ANSI.Leijen.Internal.Doc</span><span class='hs-varid'>cyan</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>56: </span>
<span class=hs-linenum>57: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>applyColor</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>58: </span><span class='hs-comment'>-- LH would need a proof that</span>
<span class=hs-linenum>59: </span><span class='hs-comment'>-- @len (cycle coloring) &gt; maxIndex v - scopedIndex v@</span>
<span class=hs-linenum>60: </span><span class='hs-comment'>-- so @!!@ is safe to use.</span>
<span class=hs-linenum>61: </span><span class='hs-definition'>applyColor</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ApplyColor</span>
<span class=hs-linenum>62: </span><span class='hs-definition'>applyColor</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>cycle</span> <span class='hs-varid'>coloring</span> <span class='hs-varop'>!!</span> <span class='hs-layout'>(</span><span class='hs-varid'>maxIndex</span> <span class='hs-varid'>v</span> <span class='hs-comment'>-</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span>
<span class=hs-linenum>63: </span>
<span class=hs-linenum>64: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum>65: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedVar</span>
<span class=hs-linenum>66: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>maxIndex</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span>
<span class=hs-linenum>67: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span> <span class='hs-varid'>i</span> <span class='hs-conop'>:</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>i</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>maxIndex</span> <span class='hs-layout'>}</span>
<span class=hs-linenum>68: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum>69: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>70: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>ScopedVar</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ScopedVar</span>
<span class=hs-linenum>71: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>maxIndex</span>    <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumVarsInScope</span>
<span class=hs-linenum>72: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>scopedIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum>73: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum>74: </span>
<span class=hs-linenum>75: </span><span class='hs-comment'>-- The number of variables in scope.</span>
<span class=hs-linenum>76: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>77: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>NumVarsInScope</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Nat</span>
</pre>
</body>
</html>